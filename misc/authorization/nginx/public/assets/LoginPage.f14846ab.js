import{Q as f}from"./QCardActions.96b23613.js";import{Q as g}from"./QPage.e45d9dd4.js";import{a as _}from"./index.2cf0d985.js";import{u as k,r as u,o as m,D as h,E as y,G as c,K as v,d as w,M as x,J as C,a3 as S}from"./index.4807e50e.js";import"./use-align.4d382a04.js";const I={style:{color:"red"}},U={setup(Q){const l=v(),t=k();u({client_id:"",user_id:"",password:"",totp:""});let o=u("");async function d(){o.value="\u30ED\u30B0\u30A4\u30F3\u51E6\u7406\u4E2D...";let n="/cadde/api/v4/ui/token/authorizationCode",s=window.location.href.split("#");var i={code:t.authInfo.keycloakCode,state:t.authInfo.keycloakState,url:s[0]+"#/"};try{const e=await _.post(n,i);if(e.status>=200&&e.status<300){let a={};a.cadde_user_id=e.data.cadde_user_id,t.updateLoginInfo(a),o.value="\u30ED\u30B0\u30A4\u30F3\u306B\u6210\u529F\u3057\u307E\u3057\u305F"}else console.log("login failed",e.status),o.value="\u30ED\u30B0\u30A4\u30F3\u306B\u5931\u6557\u3057\u307E\u3057\u305F",t.updateAuthInfo({keycloakState:"",keycloakCode:""}),l.push({path:"/logout",query:{logoutUrl:s[0]+"#/"}})}catch(e){const{status:a,statusText:p}=e.response;console.log(e.response),console.log(`Error! HTTP Status: ${a} ${p}`);let r="";e.response.data&&e.response.data.error&&(r=e.response.data.error),e.response.data&&e.response.data.message&&(r=e.response.data.message),o.value="\u30ED\u30B0\u30A4\u30F3\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002("+a+":"+r+")",t.updateAuthInfo({keycloakState:"",keycloakCode:""}),l.push({path:"/logout",query:{logoutUrl:s[0]+"#/"}})}}return m(()=>{d()}),(n,s)=>(h(),y(g,{class:"row justify-center items-center",style:{background:"linear-gradient(#f2f2f3, #f3f3f5)"}},{default:c(()=>[w(f,{class:"q-px-lg"},{default:c(()=>[x("span",I,C(S(o)),1)]),_:1})]),_:1}))}};export{U as default};
