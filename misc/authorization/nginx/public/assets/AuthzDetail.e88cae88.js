import{Q as h}from"./QCardSection.d0e48dc0.js";import{Q as w}from"./QSeparator.091cee55.js";import{Q as k}from"./QTable.d79d2923.js";import{a as B}from"./QBtn.5dd18780.js";import{Q as b}from"./QCardActions.936e3208.js";import{Q as D}from"./QCard.8b8ba1d6.js";import{u as R,r as d,D as $,N as A,d as s,G as i,K as L,ai as N,M as n,J as g,z as E,ah as U,a3 as Q}from"./index.537da17a.js";import{api as x}from"./axios.a5422dc0.js";import"./use-align.fa6ab44d.js";import"./use-dark.11a8fb07.js";import"./QItem.aa9bb720.js";import"./scroll.9c684672.js";import"./use-key-composition.4ec20917.js";import"./format.a33550d6.js";import"./selection.a41fcf3b.js";import"./use-checkbox.dff0417c.js";import"./index.2cf0d985.js";const V={class:"q-pa-md items-start q-gutter-md"},G=n("div",{class:"text-h6"},"\u914D\u4FE1\u306EURL",-1),I={class:"text-h6"},J={class:"q-pa-md"},K={style:{color:"red"}},M={style:{color:"red"}},ne={setup(O){L();const c=N(),m=R(),y=[{name:"user",label:"\u30E6\u30FC\u30B6",field:"user",align:"left"},{name:"org",label:"\u7D44\u7E54",field:"org",align:"left"},{name:"aal",label:"AAL",field:"aal",align:"left"},{name:"trade_id",label:"\u53D6\u5F15ID",field:"trade_id",align:"left"}],f=d([]),e=d([]),S=c.params.target,q=a=>"",z=(a,t,r)=>`${r}\u9805\u76EE\u4E2D${a}\uFF5E${t}\u9805\u76EE\u3092\u8868\u793A\u4E2D`;let u=d(""),l=d("");const _=()=>{u.value="",x.get("/cadde/api/v4/ui/authorization",{params:{target:S}}).then(a=>{let t=a.data,r=[];t.forEach(function(o,v){let p=null;"contract"in o?p={index:v,user:o.permission.assignee.user,org:o.permission.assignee.org,aal:o.permission.assignee.aal,trade_id:o.contract.trade_id}:p={index:v,user:o.permission.assignee.user,org:o.permission.assignee.org,aal:o.permission.assignee.aal,trade_id:null},r.push(p)}),f.value=r}).catch(function(a){console.log(a),a.response.status==403?u.value="\u6709\u52B9\u671F\u9650\u5207\u308C\u306E\u305F\u3081\u8A8D\u53EF\u8A73\u7D30\u306E\u53D6\u5F97\u304C\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002\u30ED\u30B0\u30A4\u30F3\u3057\u306A\u304A\u3057\u3066\u304F\u3060\u3055\u3044\u3002":u.value="\u30B5\u30FC\u30D0\u969C\u5BB3\u306E\u305F\u3081\u8A8D\u53EF\u8A73\u7D30\u306E\u53D6\u5F97\u304C\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002\u30B5\u30FC\u30D0\u306E\u72B6\u614B\u3092\u78BA\u8A8D\u3057\u3066\u304F\u3060\u3055\u3044\u3002"})},C=()=>{let a={};l.value="",e.value[0].trade_id!=null?a={permission:{target:c.params.target,assigner:m.cadde_user_id},contract:{trade_id:e.value[0].trade_id}}:(typeof e.value[0].user=="undefined"&&(e.value[0].user=null),typeof e.value[0].org=="undefined"&&(e.value[0].org=null),typeof e.value[0].aal=="undefined"&&(e.value[0].aal=null),a={permission:{target:c.params.target,assigner:m.cadde_user_id,assignee:{user:e.value[0].user,org:e.value[0].org,aal:e.value[0].aal,extras:null}}}),x.delete("/cadde/api/v4/ui/authorization",{data:a}).then(function(t){_()}).catch(function(t){console.log(t),t.response.status==403?l.value="\u6709\u52B9\u671F\u9650\u5207\u308C\u306E\u305F\u3081\u8A8D\u53EF\u524A\u9664\u304C\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002\u30ED\u30B0\u30A4\u30F3\u3057\u306A\u304A\u3057\u3066\u304F\u3060\u3055\u3044\u3002":t.response.status==404?l.value="":l.value="\u30B5\u30FC\u30D0\u969C\u5BB3\u306E\u305F\u3081\u8A8D\u53EF\u524A\u9664\u304C\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002\u30B5\u30FC\u30D0\u306E\u72B6\u614B\u3092\u78BA\u8A8D\u3057\u3066\u304F\u3060\u3055\u3044\u3002"})};return _(),(a,t)=>($(),A("div",V,[s(D,{class:"shadow-24 q-pa-lg"},{default:i(()=>[s(h,null,{default:i(()=>[G]),_:1}),s(w),s(h,null,{default:i(()=>[n("div",I,g(a.$route.params.target),1)]),_:1}),s(w),s(k,{columns:y,rows:f.value,title:"\u8A8D\u53EF",separator:"vertical",selection:"single","row-key":"index","rows-per-page-options":[0,10],"rows-per-page-label":"\u8868\u793A\u6570","selected-rows-label":q,selected:e.value,"onUpdate:selected":t[0]||(t[0]=r=>e.value=r),"pagination-label":z},null,8,["rows","selected"]),s(b,{class:"q-px-md"},{default:i(()=>[E(n("div",J,[s(B,{onClick:C,label:"\u8A8D\u53EF\u524A\u9664",color:"negative"})],512),[[U,e.value.length!=0]])]),_:1}),s(b,{class:"q-px-lg"},{default:i(()=>[n("span",K,g(Q(u)),1),n("span",M,g(Q(l)),1)]),_:1})]),_:1})]))}};export{ne as default};
